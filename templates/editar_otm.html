<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Editar OTM</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="icon" href="{{ url_for('static', filename='img/logo.png') }}" type="image/x-icon">
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f2f6fa; padding: 30px; }
        .form-section { background: white; padding: 25px 30px; margin-bottom: 32px; border-radius: 14px; box-shadow: 0 4px 18px rgba(0,0,0,0.08);}
        .form-section h4 { color: #004080; margin-bottom: 18px; font-weight: 700;}
        label { font-weight: 600; margin-top: 10px;}
        .checkbox-group, .radio-group { display: flex; gap: 20px; margin-top: 10px;}
        .btn-custom { padding: 12px 28px; font-size: 17px; border-radius: 8px; margin: 10px;}
        .btn-success:hover, .btn-primary:hover { opacity: 0.92;}
        .section-icon { font-size: 22px; margin-right: 8px; color: #0d6efd;}
        textarea { resize: vertical;}
    </style>
</head>
<body>
    <h1 class="bg-primary text-white p-3 rounded text-center mb-4">
        <i class="bi bi-pencil-square"></i> Editar Orden de Trabajo
    </h1>
    <form method="POST">
        <!-- Sección 1: Datos del equipo -->
        <div class="form-section">
            <h4><i class="bi bi-hospital section-icon"></i> Datos del Equipo</h4>
            <div class="mb-3">
                <label>Dependencia de Salud:</label>
                <input type="text" name="dependencia" class="form-control" value="{{ otm.dependencia }}">
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label>Número de OTM:</label>
                    <input type="text" name="numero" class="form-control" value="{{ otm.numero }}">
                </div>
                <div class="col-md-6 mb-3">
                    <label>Fecha:</label>
                    <input type="date" name="fecha" class="form-control" value="{{ otm.fecha }}">
                </div>
            </div>
            <div class="mb-3">
                <label>Área Usuaria:</label>
                <input type="text" name="area" class="form-control" value="{{ otm.area }}">
            </div>
            <div class="mb-3">
                <label>Ubicación Física:</label>
                <input type="text" name="ubicacion" class="form-control" value="{{ otm.ubicacion }}">
            </div>
        </div>
        <!-- Sección 2: Identificación del equipo -->
        <div class="form-section">
            <h4><i class="bi bi-cpu section-icon"></i> Identificación del Equipo</h4>
            <div class="mb-3">
                <label>Denominación del Equipo:</label>
                <input type="text" name="denominacion" class="form-control" value="{{ otm.denominacion }}">
            </div>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label>Marca:</label>
                    <input type="text" name="marca" class="form-control" value="{{ otm.marca }}">
                </div>
                <div class="col-md-4 mb-3">
                    <label>Modelo:</label>
                    <input type="text" name="modelo" class="form-control" value="{{ otm.modelo }}">
                </div>
                <div class="col-md-4 mb-3">
                    <label>Serie:</label>
                    <input type="text" name="serie" class="form-control" value="{{ otm.serie }}">
                </div>
            </div>
            <div class="mb-3">
                <label>Código Patrimonial:</label>
                <input type="text" name="codigo_patrimonial" class="form-control" value="{{ otm.codigo_patrimonial }}">
            </div>
        </div>
        <!-- Sección 3: Solicitud y recepción -->
        <div class="form-section">
            <h4><i class="bi bi-person-check section-icon"></i> Solicitud y Recepción</h4>
            <label>Problema presentado en el equipo:</label>
            <textarea name="problema" class="form-control" rows="3">{{ otm.problema }}</textarea>
            <div class="row mt-3">
                <div class="col-md-6">
                    <label>Fecha de solicitud del servicio:</label>
                    <input type="date" name="fecha_solicitud" class="form-control" value="{{ otm.fecha_solicitud }}">
                </div>
                <div class="col-md-6">
                    <label>Fecha de recepción:</label>
                    <input type="date" name="fecha_recepcion" class="form-control" value="{{ otm.fecha_recepcion }}">
                </div>
            </div>
        </div>
        <!-- Sección 4: Diagnóstico y prioridad -->
        <div class="form-section">
            <h4><i class="bi bi-search section-icon"></i> Diagnóstico y Prioridad</h4>
            <label>Diagnóstico Técnico:</label>
            <textarea name="diagnostico" class="form-control" rows="3">{{ otm.diagnostico }}</textarea>
            <label class="mt-3">Prioridad:</label>
            <div class="radio-group">
                <div class="form-check">
                    <input type="radio" name="prioridad" value="muy_urgente" class="form-check-input" {% if otm.prioridad == 'muy_urgente' %}checked{% endif %}>
                    <label class="form-check-label">Muy urgente</label>
                </div>
                <div class="form-check">
                    <input type="radio" name="prioridad" value="urgente" class="form-check-input" {% if otm.prioridad == 'urgente' %}checked{% endif %}>
                    <label class="form-check-label">Urgente</label>
                </div>
                <div class="form-check">
                    <input type="radio" name="prioridad" value="programar" class="form-check-input" {% if otm.prioridad == 'programar' %}checked{% endif %}>
                    <label class="form-check-label">Programar</label>
                </div>
            </div>
            <div class="mt-3">
                <label>Encargado de mantenimiento:</label>
                <input type="text" name="encargado" class="form-control" value="{{ otm.encargado }}">
            </div>
            <div class="mt-3">
                <label>Fecha de mantenimiento:</label>
                <input type="date" name="fecha_mantenimiento" class="form-control" value="{{ otm.fecha_mantenimiento }}">
            </div>
            <label class="mt-3">Modalidad de atención:</label>
            <div class="checkbox-group">
                <div class="form-check">
                    <input type="checkbox" name="modalidad[]" value="propio" class="form-check-input" {% if 'propio' in otm.modalidad %}checked{% endif %}>
                    <label class="form-check-label">Personal Propio</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="modalidad[]" value="terceros" class="form-check-input" {% if 'terceros' in otm.modalidad %}checked{% endif %}>
                    <label class="form-check-label">Servicio de Terceros</label>
                </div>
            </div>
        </div>
        <!-- Sección 5: Trabajo realizado -->
        <div class="form-section">
            <h4><i class="bi bi-tools section-icon"></i> Trabajo Realizado</h4>
            <label>Descripción del trabajo de mantenimiento ejecutado:</label>
            <textarea name="trabajo" class="form-control" rows="5">{{ otm.trabajo }}</textarea>
            <label class="mt-3">Fecha de inicio:</label>
            <input type="date" name="fecha_inicio" class="form-control" value="{{ otm.fecha_inicio }}">
            <label class="mt-3">Fecha de término:</label>
            <input type="date" name="fecha_termino" class="form-control" value="{{ otm.fecha_termino }}">
            <label class="mt-3">Garantía del servicio:</label>
            <input type="text" name="garantia" class="form-control" value="{{ otm.garantia }}">
            <label class="mt-3">Costo del servicio:</label>
            <input type="text" name="costo" class="form-control" value="{{ otm.costo }}">
            <label class="mt-3">Recomendaciones de uso y mantenimiento:</label>
            <textarea name="recomendaciones" class="form-control" rows="3">{{ otm.recomendaciones }}</textarea>
        </div>
        <!-- Sección 6: Mano de obra y materiales (formulario2) -->
        <div class="form-section">
            <h4><i class="bi bi-person-badge section-icon"></i> Mano de Obra</h4>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label>Nombre del técnico:</label>
                    <input type="text" name="nombre_tecnico" class="form-control" value="{{ otm.nombre_tecnico }}">
                </div>
                <div class="col-md-4 mb-3">
                    <label>Especialidad:</label>
                    <input type="text" name="especialidad" class="form-control" value="{{ otm.especialidad }}">
                </div>
                <div class="col-md-2 mb-3">
                    <label>Horas:</label>
                    <input type="number" name="horas" class="form-control" min="0" value="{{ otm.horas }}">
                </div>
                <div class="col-md-2 mb-3">
                    <label>Valor por hora:</label>
                    <input type="number" name="valor_hora" class="form-control" min="0" value="{{ otm.valor_hora }}">
                </div>
            </div>
            <div class="mb-3">
                <label>Costo mano de obra:</label>
                <input type="number" name="costo_mo" class="form-control" min="0" value="{{ otm.costo_mo }}">
            </div>
        </div>
        <div class="form-section">
            <h4><i class="bi bi-box-seam section-icon"></i> Materiales Utilizados</h4>
            <div class="row">
                <div class="col-md-3 mb-3">
                    <label>Origen:</label>
                    <input type="text" name="origen" class="form-control" value="{{ otm.origen }}">
                </div>
                <div class="col-md-5 mb-3">
                    <label>Descripción del material:</label>
                    <input type="text" name="descripcion_material" class="form-control" value="{{ otm.descripcion_material }}">
                </div>
                <div class="col-md-2 mb-3">
                    <label>U.M.:</label>
                    <input type="text" name="um" class="form-control" value="{{ otm.um }}">
                </div>
                <div class="col-md-2 mb-3">
                    <label>Cantidad:</label>
                    <input type="number" name="cantidad" class="form-control" min="0" value="{{ otm.cantidad }}">
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label>Costo unitario:</label>
                    <input type="number" name="costo_unitario" class="form-control" min="0" value="{{ otm.costo_unitario }}">
                </div>
                <div class="col-md-6 mb-3">
                    <label>Costo parcial:</label>
                    <input type="number" name="costo_parcial" class="form-control" min="0" value="{{ otm.costo_parcial }}">
                </div>
            </div>
        </div>
        <div class="form-section">
            <h4><i class="bi bi-calculator section-icon"></i> Totales y Otros Gastos</h4>
            <div class="row">
                <div class="col-md-4 mb-3">
                    <label>Total mano de obra:</label>
                    <input type="number" name="total_mo" class="form-control" min="0" value="{{ otm.total_mo }}">
                </div>
                <div class="col-md-4 mb-3">
                    <label>Total materiales:</label>
                    <input type="number" name="total_materiales" class="form-control" min="0" value="{{ otm.total_materiales }}">
                </div>
                <div class="col-md-4 mb-3">
                    <label>Otros gastos:</label>
                    <input type="number" name="otros_gastos" class="form-control" min="0" value="{{ otm.otros_gastos }}">
                </div>
            </div>
            <div class="row">
                <div class="col-md-6 mb-3">
                    <label>Impuestos:</label>
                    <input type="number" name="impuestos" class="form-control" min="0" value="{{ otm.impuestos }}">
                </div>
                <div class="col-md-6 mb-3">
                    <label>Total general:</label>
                    <input type="number" name="total_general" class="form-control" min="0" value="{{ otm.total_general }}">
                </div>
            </div>
        </div>
        <div class="text-center">
            <button type="submit" class="btn btn-success btn-custom">Guardar cambios</button>
            <a href="{{ url_for('resumen') }}" class="btn btn-secondary btn-custom">Cancelar</a>
        </div>
    </form>
</body>
</html>